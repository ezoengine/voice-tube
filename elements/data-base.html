<link rel="import" href="../bower_components/polymer/polymer.html">
<script src="https://cdn.firebase.com/js/client/1.1.3/firebase.js"></script>
<polymer-element name="data-base" verify attributes='url login'>
    <template>

    </template>
    <script>
    (function() {
        Polymer({
            db: '',
            login: '',
            ready: function() {
                this.db = new Firebase(this.url);
                if (this.login.indexOf('google') >= 0) {
                    this.loginWithGoogle();
                } else if (this.login.indexOf('facebook') >= 0 || this.login.indexOf('fb') >= 0) {
                    this.loginWithFacebook();
                }
            },
            query: function(node, callback) {
                this.db.child(node).once('value', function(obj) {
                    if (typeof callback === "function") {
                        callback(obj.val());
                    }
                });
            },
            update: function(node, info, callback) {
                var updateNode = this.db.child(node);
                updateNode.update(info, function() {
                    if (typeof callback === "function") {
                        callback();
                    }
                });
            },
            loginWithGoogle: function() {
                var my = this;
                this.db.authWithOAuthPopup("google", function(error, authData) {
                    my.fire('google-login', authData);
                });
            },
            loginWithFacebook: function() {
                var my = this;
                this.db.authWithOAuthPopup("facebook", function(error, authData) {
                    my.fire('facebook-login', authData);
                });
            }
        });
    })();
    </script>
</polymer-element>