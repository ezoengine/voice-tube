<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="c3-timeseries.html">
<polymer-element name="user-status" verify attributes=''>
<template>
	<c3-timeseries id='c3t'></c3-timeseries>
	<div layout vertical>
	<div>目前進度: {{progress}} %</div>
		<template repeat='{{s in sentences}}'>
			<div layout horizontal>
				<div style='width:70px;'>{{s.idx<10? '0'+s.idx : s.idx}}</div>
				<div flex >{{s.score}}%</div>
				<div flex>{{s.totalSpendTime|convert}}</div>
				<div style='width:70px;'>{{s.practiceTimes}}</div>
				<div flex four>{{s.wrongAns}}</div>
			</div>
		</template>
	</div>
</template>
<script>
(function(){
    function timeConvert(n){
    	var sec = parseInt(n);
    	var min = sec>60 ? parseInt(sec/60): 0;
    	var hour = min>60 ? parseInt(min/60): 0;
    	if(hour>0){
    		return hour + '小時' + min%60 +'分鐘';
    	}
    	if(min>0){
    		return min + '分' + sec%60 +'秒';
    	}
    	return min + '分' + sec +'秒';
    };
	PolymerExpressions.prototype.convert = function(input) {
  		return timeConvert(input);
	};
	Polymer({
		ready:function(){
			
	    },
	    info:function(info){
	    	this.progress = info.progress;
	    	this.sentences = info.sentences;
	    },
	    renderChart:function(user){
			var info = user.studyHistory();
			var columns = [[],['time(min)'],['sentence']]
			for(var key in info){
				columns[0].push(key);
				var min = parseInt(info[key].spendTime/60);
				columns[1].push(min);
				columns[2].push(info[key].sentenceAmt);
			}
			this.$.c3t.render(columns);

	    	
	    }

	});
})();
</script>
</polymer-element>